<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pego | Entrega & Carona</title>
<style>
:root{
  --blue:#0a6cff;
  --green:#00c48c;
  --balloon:#0a6cff;
}
*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif;margin:0;padding:0;}
body{
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:15px;
  background: linear-gradient(120deg, var(--blue), var(--green));
  color:#fff;
}
header{text-align:center;margin-bottom:20px;}
header h1{font-size:2rem;}
header p{margin-top:5px;font-size:1.1rem;}

/* BAL√ïES */
#welcomeBalloons{
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-bottom:20px;
}
#welcomeBalloons button{
  background:var(--balloon);
  color:#fff;
  font-weight:bold;
  border:none;
  border-radius:25px;
  padding:12px;
  cursor:pointer;
  transition:0.2s;
}
#welcomeBalloons button:hover{opacity:0.85;}

/* FORMUL√ÅRIOS E CARDS */
form, .card, .reservation-card, .testimonial-card{
  background:#fff;
  padding:15px;
  border-radius:12px;
  box-shadow:0 4px 12px rgba(0,0,0,0.2);
  margin-bottom:12px;
  color:#000;
}
input,select,textarea{width:100%;padding:10px;margin:6px 0;border-radius:12px;border:1px solid #ddd;}
button.green{background:var(--green); color:#fff;}
button.primary{background:var(--blue); color:#fff;}
img.preview{width:80px;height:80px;border-radius:50%;object-fit:cover;margin-bottom:10px;}

/* DEPOIMENTOS */
.testimonial-card{margin-bottom:10px;}
.testimonial-card p{margin:4px 0;}
</style>
</head>
<body>

<header>
  <h1>Pego | Entrega & Carona</h1>
  <p>Seja bem-vindo! Conectando pessoas e cidades</p>
</header>

<div id="welcomeBalloons">
  <button id="btnAbout">Quem somos n√≥s?</button>
  <button id="btnPurpose">Nossa finalidade</button>
  <button id="btnTestimonials">Depoimentos</button>
  <button id="btnRegister">Criar Cadastro</button>
  <button id="btnLogin">Entrar</button>
  <button id="btnSearch">Pesquisar Carona/Entrega</button>
  <button id="btnReservations">Reservas Pendentes</button>
</div>

<div id="sections" style="width:100%; max-width:400px;">

  <div id="about" style="display:none;padding:10px;background:rgba(255,255,255,0.9);color:#000;border-radius:12px;">
    Somos a plataforma Pego | Entrega & Carona. Conectamos pessoas que precisam viajar ou enviar itens com seguran√ßa e economia.
  </div>

  <div id="purpose" style="display:none;padding:10px;background:rgba(255,255,255,0.9);color:#000;border-radius:12px;">
    Nossa finalidade √© ajudar voc√™ a economizar e conhecer pessoas novas enquanto viaja ou despacha itens. üöóüì¶üåé
  </div>

  <div id="testimonials" style="display:none;">
    <div class="testimonial-card">‚ÄúO Pego facilitou minha viagem e ainda economizei muito!‚Äù ‚Äì Jo√£o</div>
    <div class="testimonial-card">‚ÄúConsegui enviar meu pacote com seguran√ßa e rapidez!‚Äù ‚Äì Maria</div>
    <div class="testimonial-card">‚ÄúPlataforma inovadora e pr√°tica para o dia a dia.‚Äù ‚Äì Ana</div>
  </div>

  <form id="registerForm" style="display:none;">
    <input id="r_name" placeholder="Nome completo" required />
    <input id="r_email" type="email" placeholder="Email" required />
    <input id="r_pass" type="password" placeholder="Senha" required />
    <select id="r_type" required>
      <option value="">Selecione tipo</option>
      <option value="solicitante">Solicitante</option>
      <option value="condutor">Condutor</option>
    </select>
    <input id="r_telefone" placeholder="Telefone" required />
    <input id="r_rua" placeholder="Rua" required />
    <input id="r_numero" placeholder="N√∫mero" required />
    <input id="r_bairro" placeholder="Bairro" required />
    <input id="r_cidade" placeholder="Cidade" required />
    <input id="r_estado" placeholder="Estado" required />
    <label>Foto de Perfil (opcional)</label>
    <input id="r_selfie" type="file" accept="image/*" />
    <img id="preview" class="preview hidden"/>
    <button id="registerBtn" class="green" type="button">Criar Conta</button>
  </form>

  <form id="loginForm" style="display:none;">
    <input id="l_email" type="email" placeholder="Email" />
    <input id="l_pass" type="password" placeholder="Senha" />
    <button id="loginBtn" class="primary" type="button">Entrar</button>
  </form>

  <div id="search" style="display:none;">
    <select id="search_type">
      <option value="carona">Carona</option>
      <option value="entrega">Entrega</option>
    </select>
    <input id="search_origem" placeholder="Cidade de origem" />
    <input id="search_destino" placeholder="Cidade de destino" />
    <button id="searchBtn" class="primary">Pesquisar</button>
    <div id="search_results"></div>
  </div>

  <div id="reservations" style="display:none;">
    <h3>Reservas Pendentes</h3>
    <div id="pending_reservations"></div>
  </div>

</div>

<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-storage-compat.js"></script>

<script>
  // INICIALIZA√á√ÉO FIREBASE
  const firebaseConfig = {
    apiKey: "AIzaSyDGU_N1Un8Eo5DuaVbI4vru63ox_tSBR1o",
    authDomain: "pego-entrego-c3010.firebaseapp.com",
    projectId: "pego-entrego-c3010",
    storageBucket: "pego-entrego-c3010.firebasestorage.app",
    messagingSenderId: "118361704352",
    appId: "1:118361704352:web:4a714264d54169a6dc46c5"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();
  const storage = firebase.storage();

  function showSection(id){
    ['about','purpose','testimonials','registerForm','loginForm','search','reservations']
      .forEach(s=>document.getElementById(s).style.display=(s===id?'block':'none'));
  }

  // BAL√ïES
  document.getElementById('btnAbout').onclick = ()=>showSection('about');
  document.getElementById('btnPurpose').onclick = ()=>showSection('purpose');
  document.getElementById('btnTestimonials').onclick = ()=>showSection('testimonials');
  document.getElementById('btnRegister').onclick = ()=>showSection('registerForm');
  document.getElementById('btnLogin').onclick = ()=>showSection('loginForm');
  document.getElementById('btnSearch').onclick = ()=>showSection('search');
  document.getElementById('btnReservations').onclick = ()=>showSection('reservations');

  // PREVIEW SELFIE
  document.getElementById('r_selfie').onchange=function(e){
    const file=e.target.files[0];
    if(file){
      const reader=new FileReader();
      reader.onload=function(ev){
        const img=document.getElementById('preview');
        img.src=ev.target.result;
        img.classList.remove('hidden');
      };
      reader.readAsDataURL(file);
    }
  };

  // CADASTRO
  document.getElementById('registerBtn').onclick=async function(){
    const name=document.getElementById('r_name').value;
    const email=document.getElementById('r_email').value;
    const pass=document.getElementById('r_pass').value;
    const type=document.getElementById('r_type').value;
    const telefone=document.getElementById('r_telefone').value;
    const rua=document.getElementById('r_rua').value;
    const numero=document.getElementById('r_numero').value;
    const bairro=document.getElementById('r_bairro').value;
    const cidade=document.getElementById('r_cidade').value;
    const estado=document.getElementById('r_estado').value;
    const selfieFile=document.getElementById('r_selfie').files[0];

    if(!name||!email||!pass||!type||!telefone||!rua||!numero||!bairro||!cidade||!estado){
      return alert("Preencha todos os campos obrigat√≥rios!");
    }

    try{
      const userCredential=await auth.createUserWithEmailAndPassword(email,pass);
      const uid=userCredential.user.uid;
      let selfieURL='';
      if(selfieFile){
        const selfieRef=storage.ref(`users/${uid}/selfie.jpg`);
        await selfieRef.put(selfieFile);
        selfieURL=await selfieRef.getDownloadURL();
      }
      await db.collection('users').doc(uid).set({
        name,email,type,telefone,rua,numero,bairro,cidade,estado,selfieURL,approved:true,
        createdAt:firebase.firestore.FieldValue.serverTimestamp()
      });
      alert("Cadastro realizado! Fa√ßa login.");
      showSection('loginForm');
    }catch(err){alert("Erro: "+err.message);}
  };

  // LOGIN
  document.getElementById('loginBtn').onclick=async function(){
    const email=document.getElementById('l_email').value;
    const pass=document.getElementById('l_pass').value;
    try{
      const userCredential=await auth.signInWithEmailAndPassword(email,pass);
      alert("Login realizado!");
    }catch(err){alert("Erro: "+err.message);}
  };

  // PESQUISA
  document.getElementById('searchBtn').onclick=async function(){
    const type=document.getElementById('search_type').value;
    const origem=document.getElementById('search_origem').value.toLowerCase();
    const destino=document.getElementById('search_destino').value.toLowerCase();
    const resultsDiv=document.getElementById('search_results');
    resultsDiv.innerHTML="";

    if(!origem||!destino){return alert("Preencha origem e destino");}

    const snapshot=await db.collection(type).where('origem','==',origem).where('destino','==',destino).get();
    if(snapshot.empty){resultsDiv.innerHTML="<p>Nenhuma oferta encontrada.</p>"; return;}
    snapshot.forEach(doc=>{
      const data=doc.data();
      const div=document.createElement('div');
      div.className='card';
      div.innerHTML=`<p><strong>${type.toUpperCase()}</strong></p>
                     <p>${data.origem} ‚Üí ${data.destino}</p>
                     <p>Criado por: ${data.userName||"An√¥nimo"}</p>`;
      resultsDiv.appendChild(div);
    });
  };
</script>

</body>
</html>